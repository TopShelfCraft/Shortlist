{% extends "shortlist/_layout" %}
{% set lists = craft.shortlist.lists %}

{% block content %}


{% if craft.shortlist.error is not null %}
<div class="alert alert-danger">
    {{ craft.shortlist.error }}
</div>
{% endif %}

<div class="row">
    <div class="col-md-6">

        <h2>Entries</h2>
        <p>As a user you can add any of the following items to your lists</p>
        <hr/>

        {% for news in craft.entries.section('news') %}
        <article class="blog-article {% if loop.first %}latest{% endif %}">
            <div class="news-main">
                <h3>{{ news.title }}</h3>
            </div>

            <div class="shortlist">

                {% set item = craft.shortlist.item(news.id) %}

                {% if item.inList %}
                <a class="btn btn-danger" href="{{ item.removeActionUrl }}">Remove from : {{ item.parentList.title }}</a>
                {% else %}
                <a class="btn btn-primary" href="{{ item.addActionUrl }}">Add to : {{ item.parentList.title }}</a>
                {% endif %}

                {% if item.otherLists is not empty %}
                <p>Other Lists</p>
                {% for other in item.otherLists %}
                <ul class="list-unstyled">
                    {% if other.inList %}
                    <li><a href="{{ other.removeActionUrl }}" class="btn btn-sm btn-danger">Remove from : {{
                        other.parentList.title }}</a></li>
                    {% else %}
                    <li><a href="{{ other.addActionUrl }}" class="btn btn-sm btn-default">Add to : {{ other.parentList.title
                        }}</a></li>
                    {% endif %}
                </ul>
                {% endfor %}
                {% endif %}

                <h4>Add to New List</h4>

                <form class="form-horizontal" method="post" action="" accept-charset="UTF-8">
                    <input type="hidden" name="action" value="shortlist/list/new"/>
                    <input type="hidden" name="elementId" value="{{ news.id }}"/>

                    <div class="row">
                        <div class="col-lg-6">
                            <div class="input-group">
                                <input type="text" class="form-control" name="listTitle" id="listTitle"
                                       placeholder="New List Title...">

                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="submit">Create + Add</button>
                                </span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

        </article>
        <hr/>
        {% endfor %}
    </div>
    <div class="col-md-6">

        <h2>Lists</h2>
        <p>Here are your current lists, and their contents.</p>
        <hr/>
        {% if lists is empty %}
            <p><em>You have no lists at the moment.</em> <a href="{{ craft.shortlist.newListActionUrl }}">Create an empty list?</a></p>
        {% else %}

            {% for list in lists %}
                <h4>({{ list.id }}) {{ list.title }}</h4>

                <p><span class="label label-info">{{list.status}}</span> {% if list.default %}<span class="label label-success">default</span>{%
                    endif %} Owned by <em>{{ list.owner }}</em> {{ list.owner.email }}</p>

                <div class="well">
                    <a href="{{ list.deleteActionUrl }}" class="btn btn-danger">Delete List</a>
                    {% if list.default == false %}<a href="{{ list.makeDefaultActionUrl }}" class="btn">Make Default</a>{% endif %}
                    {% if list.items is not empty %}<a href="{{ list.clearActionUrl }}" class="btn">Clear List</a>{% endif %}
                </div>


                {% if list.items is empty %}
                    <p><em>This list is empty</em></p>
                {% else %}
                    <ul class="list-group">
                        {% for item in list.items %}
                            <li class="list-group-item"><a href="{{ item.removeActionUrl }}" class="btn btn-danger btn-xs badge"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
                                {{ item.id }} <strong>{{ item.title }}</strong>
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}

                <hr/>

            {% endfor %}
        {% endif %}



    </div>
    {% endblock %}
